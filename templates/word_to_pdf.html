<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Word → PDF Dönüştür • Botlab Tools</title>

    <style>
        *{margin:0;padding:0;box-sizing:border-box;}
        body{
            font-family:system-ui, sans-serif;
            background:radial-gradient(circle at top,#1a2043 0,#050814 55%,#020308 100%);
            color:#f5f7ff;
        }
        :root{
            --bg-card:#11172f;
            --bg-soft:#181f3a;
            --text-muted:#9ca4c8;
            --accent:#67e8f9;
        }
        .page-shell{max-width:1180px;margin:auto;padding:24px 16px 60px;}

        /* HEADER */
        .header{
            display:flex;justify-content:space-between;align-items:center;
            margin-bottom:30px;
        }
        .brand{display:flex;align-items:center;gap:10px;cursor:pointer;}
        .brand-logo{
            width:38px;height:38px;border-radius:11px;
            background:radial-gradient(circle at 25% 0,#67e8f9 0,#4f8dff 40%,#181f3a 100%);
            display:flex;align-items:center;justify-content:center;
            font-weight:700;color:#020617;font-size:18px;
        }
        .brand-text-main{font-size:18px;font-weight:700;}
        .brand-text-sub{font-size:11px;color:var(--text-muted);}
        .header-right{display:flex;align-items:center;gap:12px;}
        .btn{
            padding:8px 16px;border-radius:999px;font-size:13px;cursor:pointer;border:none;
        }
        .btn-ghost{background:rgba(15,23,42,0.8);border:1px solid rgba(148,163,255,0.35);color:white;}
        .btn-premium{background:linear-gradient(135deg,#f59e0b,#d97706);color:white;font-weight:600;}
        .btn-primary{background:linear-gradient(135deg,#4f8dff,#7c3aed);color:white;}

        /* DROPZONE */
        .box{
            margin-top:30px;padding:40px;border:2px dashed rgba(255,255,255,0.2);
            border-radius:16px;text-align:center;
            background:rgba(15,23,42,0.55);
        }
        .box.drag{border-color:#67e8f9;background:rgba(103,232,249,0.12);}
        .box input{display:none;}
        .box p{font-size:14px;color:var(--text-muted);}
        .submit-btn{
            margin-top:26px;padding:12px 22px;
            border-radius:999px;font-size:15px;font-weight:600;
            background:linear-gradient(135deg,#4f8dff,#7c3aed);
            color:white;border:none;cursor:pointer;
        }

        /* RESULT */
        .result{
            margin-top:28px;padding:20px;border-radius:14px;
            background:var(--bg-soft);display:none;
        }
        .result a{
            color:var(--accent);font-size:14px;font-weight:600;
        }

        /* POPUP */
        #premiumPopup{
            position:fixed;inset:0;background:rgba(0,0,0,0.55);
            display:none;align-items:center;justify-content:center;z-index:9999;
        }
        #premiumPopup .modal{
            width:360px;background:var(--bg-soft);
            padding:20px;border-radius:16px;
            border:1px solid rgba(255,255,255,0.1);
        }
    </style>

    <script>
        let selectedFile = null;

        function openPremiumPopup(){document.getElementById("premiumPopup").style.display="flex";}
        function closePremiumPopup(){document.getElementById("premiumPopup").style.display="none";}

        async function loadPremiumSettings(){
            try{
                const r = await fetch("/get_settings");
                const s = await r.json();
                document.getElementById("premiumWhatsappBtn").href =
                    "https://wa.me/"+s.popup.phone+"?text=Premium%20paket%20almak%20istiyorum";
            }catch(e){}
        }
        document.addEventListener("DOMContentLoaded", loadPremiumSettings);

        function allowDrop(ev){ev.preventDefault();document.getElementById("drop").classList.add("drag");}
        function leaveDrop(){document.getElementById("drop").classList.remove("drag");}
        function dropFile(ev){
            ev.preventDefault();
            document.getElementById("drop").classList.remove("drag");
            selectedFile = ev.dataTransfer.files[0];
            document.getElementById("fileName").innerText = selectedFile.name;
        }
        function pickFile(){document.getElementById("fileInput").click();}
        function handleFile(e){
            selectedFile = e.target.files[0];
            document.getElementById("fileName").innerText = selectedFile.name;
        }

        async function convertWord(){
            if(!selectedFile){alert("Lütfen bir Word dosyası yükleyin.");return;}

            const fd = new FormData();
            fd.append("file", selectedFile);

            const res = await fetch("/api/pdf/word_to_pdf", {method:"POST", body:fd});
            
            if(!res.ok){
                alert("Dönüştürme başarısız. Backend endpoint eksik olabilir.");
                return;
            }

            const blob = await res.blob();
            const url = URL.createObjectURL(blob);

            document.getElementById("resultLink").href = url;
            document.getElementById("result").style.display = "block";
        }
    </script>
</head>

<body>

<!-- POPUP -->
<div id="premiumPopup">
    <div class="modal">
        <h3 style="font-size:18px;margin-bottom:8px;">Premium Gerekli</h3>
        <p style="font-size:13px;color:var(--text-muted);margin-bottom:14px;">
            Bu özellik Premium kullanıcılar için aktiftir.
        </p>

        <a id="premiumWhatsappBtn" href="#" target="_blank"
           style="display:block;padding:10px;text-align:center;
           background:linear-gradient(135deg,#f59e0b,#d97706);
           border-radius:10px;color:white;font-weight:600;">
            WhatsApp ile Satın Al →
        </a>

        <button onclick="closePremiumPopup()" style="
            width:100%;margin-top:10px;background:none;border:none;
            color:#888;font-size:12px;cursor:pointer;">Kapat</button>
    </div>
</div>

<!-- HEADER -->
<header class="header">
    <div class="brand" onclick="window.location.href='/'">
        <div class="brand-logo">B</div>
        <div>
            <div class="brand-text-main">Botlab Tools</div>
            <div class="brand-text-sub">PDF • Görsel • Vektör</div>
        </div>
    </div>

    <div class="header-right">
        <button class="btn btn-premium" onclick="openPremiumPopup()">Premium Al</button>
        <button class="btn btn-ghost" onclick="window.location.href='/admin_login'">Giriş Yap</button>
        <button class="btn btn-primary" onclick="window.location.href='/'">Ana Sayfa</button>
    </div>
</header>

<div class="page-shell">

    <h1 style="font-size:24px;font-weight:700;margin-bottom:14px;">
        Word → PDF Dönüştür
    </h1>
    <p style="font-size:14px;color:var(--text-muted);max-width:520px;margin-bottom:20px;">
        DOC / DOCX belgelerinizi bozulmadan PDF’e dönüştürün.
    </p>

    <!-- DROPZONE -->
    <div id="drop" class="box"
         ondragover="allowDrop(event)"
         ondragleave="leaveDrop()"
         ondrop="dropFile(event)"
         onclick="pickFile()">

        <input id="fileInput" type="file" accept=".doc,.docx" onchange="handleFile(event)" />

        <h3 style="font-size:18px;margin-bottom:6px;">Word Dosyanızı Yükleyin</h3>
        <p id="fileName">Sürükleyip bırakın veya tıklayın</p>
    </div>

    <button class="submit-btn" onclick="convertWord()">PDF'e Dönüştür</button>

    <!-- RESULT -->
    <div id="result" class="result">
        <span style="font-size:14px;">Hazır! → </span>
        <a id="resultLink" href="#" download="donusturulmus.pdf">PDF Dosyasını İndir</a>
    </div>

</div>

</body>
</html>
