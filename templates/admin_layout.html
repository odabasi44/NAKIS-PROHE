{% extends "base.html" %}

{% block title %}Admin Panel{% endblock title %}

{% block content %}
<div class="flex min-h-[calc(100vh-80px-100px)]"> <!-- Navbar ve Footer yÃ¼ksekliÄŸi Ã§Ä±karÄ±ldÄ± -->
    
    <!-- Sol Sidebar -->
    <aside class="w-64 bg-gray-900/50 border-r border-white/5 p-6 space-y-8 sticky top-20">
        
        <div class="flex flex-col items-start">
            <div class="flex items-center gap-3 mb-4">
                <div class="w-8 h-8 rounded-full bg-blue-500 flex items-center justify-center text-white font-bold text-sm">B</div>
                <div>
                    <span class="font-bold text-white block">Botlab Admin</span>
                    <span class="text-xs text-gray-500 block">PRO PANEL V2.0</span>
                </div>
            </div>
            
            <a href="/admin_logout" class="text-xs text-red-500 hover:text-red-400 transition ml-1">
                Ã‡Ä±kÄ±ÅŸ Yap
            </a>
        </div>

        <!-- YÃ¶netim MenÃ¼sÃ¼ -->
        <nav class="space-y-2">
            <h3 class="text-xs font-semibold text-gray-500 uppercase tracking-wider mb-2">YÃ¶netim</h3>
            
            <a id="nav-dashboard" onclick="showTab('dashboard')" class="sidebar-link active cursor-pointer" data-title="Genel BakÄ±ÅŸ" data-subtitle="Sistem Ä°statistikleri ve Ã–zet Durum.">
                <span class="w-5 h-5 mr-3">ğŸ“Š</span> Genel BakÄ±ÅŸ
            </a>
            
            <a id="nav-users" onclick="showTab('users')" class="sidebar-link cursor-pointer" data-title="KullanÄ±cÄ±lar & Ãœyelik" data-subtitle="Premium Ã¼ye listesi ve dÃ¼zenlemeler.">
                <span class="w-5 h-5 mr-3">ğŸ‘¥</span> KullanÄ±cÄ±lar & Ãœyelik
            </a>
            
            <a id="nav-tools" onclick="showTab('tools')" class="sidebar-link cursor-pointer" data-title="AraÃ§ YÃ¶netimi (BakÄ±m)" data-subtitle="Limit ve bakÄ±m ayarlarÄ±.">
                <span class="w-5 h-5 mr-3">ğŸ› ï¸</span> AraÃ§ YÃ¶netimi (BakÄ±m)
            </a>
        </nav>

        <!-- MÃ¼ÅŸteri Ä°liÅŸkileri -->
        <nav class="space-y-2">
            <h3 class="text-xs font-semibold text-gray-500 uppercase tracking-wider mb-2">MÃ¼ÅŸteri Ä°liÅŸkileri</h3>
            
            <a id="nav-tickets" onclick="showTab('tickets')" class="sidebar-link cursor-pointer" data-title="Destek Talepleri" data-subtitle="KullanÄ±cÄ± taleplerini yÃ¶netin." style="position:relative;">
                <span class="w-5 h-5 mr-3">ğŸ“§</span> Destek Talepleri
                <span class="absolute right-0 top-1/2 -translate-y-1/2 text-xs bg-red-600 rounded-full h-5 w-5 flex items-center justify-center">2</span>
            </a>
            
            <a id="nav-reports" onclick="showTab('reports')" class="sidebar-link cursor-pointer" data-title="Raporlar & Analiz" data-subtitle="KullanÄ±m istatistikleri.">
                <span class="w-5 h-5 mr-3">ğŸ“ˆ</span> Raporlar & Analiz
            </a>
            
            <a id="nav-settings" onclick="showTab('settings')" class="sidebar-link cursor-pointer" data-title="Site AyarlarÄ±" data-subtitle="Kritik yapÄ±landÄ±rmalar.">
                <span class="w-5 h-5 mr-3">âš™ï¸</span> Site AyarlarÄ±
            </a>
        </nav>
    </aside>

    <!-- Ana Ä°Ã§erik AlanÄ± -->
    <section class="flex-1 p-8">
        
        <!-- Dinamik BaÅŸlÄ±k -->
        <div class="mb-8">
            <div class="flex justify-between items-center">
                <h1 id="admin-title" class="text-2xl font-bold text-white">Genel BakÄ±ÅŸ</h1>
                <span class="text-xs bg-green-700/30 text-green-400 px-3 py-1 rounded-full">ğŸŸ¢ Sunucu: Online</span>
            </div>
            <p id="admin-subtitle" class="text-sm text-gray-500">Sistem Ä°statistikleri ve Ã–zet Durum.</p>
        </div>

        <!-- admin.html iÃ§eriÄŸi buraya gelecek -->
        {% block admin_content %}{% endblock admin_content %}

    </section>

</div>

<style>
    .sidebar-link {
        display: flex;
        align-items: center;
        padding: 10px 12px;
        border-radius: 8px;
        color: #94a3b8; /* text-gray-400 */
        font-weight: 500;
        transition: all 0.2s;
        text-decoration: none;
    }
    .sidebar-link:hover {
        background: #1f2937; /* bg-gray-800 */
        color: white;
    }
    .sidebar-link.active {
        background: #3b82f6; /* bg-blue-600 */
        color: white;
        box-shadow: 0 4px 10px rgba(59, 130, 246, 0.4);
    }
    .card {
        background: #0c1120;
        border: 1px solid rgba(255,255,255,0.1);
        border-radius: 12px;
    }
    .input-dark {
        background: #02040a;
        border: 1px solid rgba(255,255,255,0.1);
        color: white;
        border-radius: 8px;
        padding: 10px 14px;
        outline: none;
        transition: border-color 0.2s;
    }
</style>

<script>
    // Dinamik baÅŸlÄ±k ve alt baÅŸlÄ±k gÃ¼ncelleme fonksiyonu
    function updateAdminHeader(title, subtitle) {
        document.getElementById('admin-title').textContent = title;
        document.getElementById('admin-subtitle').textContent = subtitle;
    }

    // Tab deÄŸiÅŸtirme ve veriyi yÃ¼kleme fonksiyonu
    function showTab(tabName) {
        // TÃ¼m sekmeleri gizle ve navigasyon linklerini de-aktif et
        document.querySelectorAll('[id^="tab-"]').forEach(el => el.classList.add('hidden'));
        document.querySelectorAll('.sidebar-link').forEach(el => el.classList.remove('active'));
        
        // SeÃ§ili sekme elementini gÃ¶ster
        const tabElement = document.getElementById('tab-' + tabName);
        if(tabElement) tabElement.classList.remove('hidden');

        // Navigasyon elementini aktif et
        const navElement = document.getElementById('nav-' + tabName);
        if(navElement) navElement.classList.add('active');

        // BaÅŸlÄ±ÄŸÄ± ve alt baÅŸlÄ±ÄŸÄ± data-attribute'lardan al
        const title = navElement.dataset.title || "YÃ¶netim Paneli";
        const subtitle = navElement.dataset.subtitle || "Sistem Bilgileri.";

        updateAdminHeader(title, subtitle);

        // Veri Ã§ekme fonksiyonlarÄ±nÄ± Ã§aÄŸÄ±r
        if (tabName === 'users' && typeof fetchUsers === 'function') {
            fetchUsers();
        } else if (tabName === 'dashboard' && typeof fetchDashboardData === 'function') {
            fetchDashboardData();
        }
        // DiÄŸer sekmeler iÃ§in buraya ekleme yapÄ±labilir
    }
    
    // Sayfa yÃ¼klendiÄŸinde varsayÄ±lan olarak dashboard'u aÃ§
    document.addEventListener('DOMContentLoaded', () => {
        // URL'deki hash'i kontrol et (Ã¶rn: /admin#users)
        const hash = window.location.hash.substring(1); 
        if (hash && document.getElementById('nav-' + hash)) {
            showTab(hash);
        } else {
            showTab('dashboard'); 
        }
    });

    // Modal fonksiyonlarÄ± (base.html'den gelmeli, ama burada da tanÄ±mlÄ±yoruz)
    function openModal(id) {
        const modal = document.getElementById(id);
        if(modal) {
            modal.classList.remove('hidden');
            modal.classList.add('flex');
        }
    }

    function closeModal(id) {
        const modal = document.getElementById(id);
        if (modal) {
            modal.classList.add('hidden');
            modal.classList.remove('flex');
        }
    }
</script>
{% endblock content %}
