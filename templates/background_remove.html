<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <title>Arka Plan Kaldır • Botlab Tools</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <style>
        :root {
            --bg: #050814;
            --panel: #0c1226;
            --card: #11182f;
            --border: rgba(255,255,255,0.08);
            --text: #e2e8f0;
            --text-soft: #94a3b8;
            --accent: #4f8dff;
            --accent-strong: #67e8f9;
            --btn-grad: linear-gradient(135deg, #4f8dff, #7c3aed);
        }

        body {
            margin: 0;
            background: radial-gradient(circle at top, #1a2043 0, #050814 55%);
            font-family: system-ui, sans-serif;
            color: var(--text);
        }

        .container {
            max-width: 900px;
            margin: auto;
            padding: 26px 16px;
        }

        header {
            display: flex; justify-content: space-between; align-items: center;
            margin-bottom: 26px;
        }

        .brand {
            display: flex; align-items: center; gap: 10px; cursor: pointer;
        }

        .brand-logo {
            width: 36px; height: 36px;
            border-radius: 10px;
            background: radial-gradient(circle at 25% 0, #67e8f9 0, #4f8dff 40%);
            display: flex; align-items: center; justify-content: center;
            font-weight: 700; color: #020617;
        }

        .btn {
            border: none;
            padding: 9px 16px;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 600;
            color: white;
        }

        .btn-primary {
            background: var(--btn-grad);
        }

        .btn-premium {
            background: linear-gradient(135deg, #f59e0b, #d97706);
        }

        .upload-box {
            background: var(--card);
            border: 2px dashed var(--border);
            padding: 35px;
            text-align: center;
            border-radius: 14px;
            cursor: pointer;
            transition: 0.3s;
        }

        .upload-box:hover {
            border-color: var(--accent);
            background: rgba(255,255,255,0.04);
        }

        #preview {
            margin-top: 22px;
            display: none;
        }

        #preview img {
            max-width: 100%;
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(0,0,0,0.45);
        }

        .loader {
            display: none;
            margin-top: 18px;
            text-align: center;
            font-size: 14px;
            color: var(--accent-strong);
        }

        .result-box {
            margin-top: 26px;
            background: var(--card);
            border: 1px solid var(--border);
            padding: 18px;
            border-radius: 14px;
            display: none;
        }

        .download-btn {
            display: inline-block;
            margin-top: 12px;
            padding: 10px 18px;
            background: var(--btn-grad);
            color: white;
            text-decoration: none;
            border-radius: 10px;
            font-weight: 600;
        }
    </style>
</head>
<body>

<div class="container">

    <!-- HEADER -->
    <header>
        <div class="brand" onclick="window.location.href='/'">
            <div class="brand-logo">B</div>
            <div>
                <div style="font-size:17px; font-weight:700;">Botlab Tools</div>
                <div style="font-size:11px; color:var(--text-soft);">Arka Plan Kaldır</div>
            </div>
        </div>

        <div>
            <button class="btn btn-premium" onclick="openPremium()">Premium Satın Al</button>
            <button class="btn btn-primary" onclick="window.location.href='/admin_login'">Giriş Yap</button>
        </div>
    </header>

    <h2 style="margin-bottom: 14px;">Arka Plan Kaldır (ONNX – Ultra Hızlı)</h2>
    <p style="color: var(--text-soft); margin-bottom: 20px;">
        Fotoğrafınızın arka planını saniyeler içinde kaldırın. PNG formatında şeffaf çıktı alın.
    </p>

    <!-- DRAG & DROP -->
    <div class="upload-box" id="dropZone">
        <p style="font-size:14px; margin-bottom:8px;">Resmi buraya sürükleyin veya tıklayın</p>
        <input type="file" id="fileInput" accept="image/*" style="display:none;">
        <button class="btn btn-primary" onclick="document.getElementById('fileInput').click()">Resim Seç</button>
    </div>

    <div id="preview">
        <h3>Önizleme:</h3>
        <img id="previewImg" src="">
    </div>

    <div class="loader" id="loading">⏳ İşleniyor... Lütfen bekleyin.</div>

    <div class="result-box" id="resultBox">
        <h3>Sonuç:</h3>
        <img id="resultImg">
        <br>
        <a id="downloadBtn" class="download-btn" download="arka_plan_silindi.png">İndir</a>
    </div>
</div>

<!-- PREMIUM POPUP -->
<div id="premium-popup"
     style="position:fixed; inset:0; display:none; align-items:center; justify-content:center;
            background:rgba(0,0,0,0.55); z-index:9999;">
    <div style="
         background:#0f172a; padding:20px; border-radius:12px;
         border:1px solid rgba(255,255,255,0.12); width:320px;">
        <h3>✨ Premium Paket</h3>
        <p style="color:#94a3b8; font-size:13px;">
            Sınırsız kullanım ve yüksek hız için Premium'a geçin.
        </p>

        <button class="btn btn-premium"
                style="width:100%; margin-top:10px;"
                onclick="window.open('https://wa.me/905335620807?text=Premium%20paket%20almak%20istiyorum','_blank')">
            WhatsApp ile Satın Al
        </button>

        <button class="btn"
                style="width:100%; margin-top:10px; background:#1e293b;"
                onclick="document.getElementById('premium-popup').style.display='none'">
            Kapat
        </button>
    </div>
</div>


<script>
function openPremium() {
    document.getElementById("premium-popup").style.display = "flex";
}

let fileData = null;

// Drag & Drop
const dropZone = document.getElementById("dropZone");
dropZone.addEventListener("dragover", (e) => {
    e.preventDefault();
    dropZone.style.borderColor = "#67e8f9";
});
dropZone.addEventListener("dragleave", () => {
    dropZone.style.borderColor = "var(--border)";
});
dropZone.addEventListener("drop", (e) => {
    e.preventDefault();
    dropZone.style.borderColor = "var(--border)";
    handleFile(e.dataTransfer.files[0]);
});

document.getElementById("fileInput").addEventListener("change", function () {
    handleFile(this.files[0]);
});


function handleFile(file) {
    fileData = file;

    const reader = new FileReader();
    reader.onload = function (e) {
        document.getElementById("previewImg").src = e.target.result;
        document.getElementById("preview").style.display = "block";
    };
    reader.readAsDataURL(file);

    uploadImage();
}


async function uploadImage() {

    if (!fileData) return;

    document.getElementById("loading").style.display = "block";

    const formData = new FormData();
    formData.append("image", fileData);
    formData.append("email", "guest");

    const res = await fetch("/api/remove_bg", {
        method: "POST",
        body: formData
    });

    document.getElementById("loading").style.display = "none";

    const data = await res.json();

    if (!data.success) {
        alert("Hata: " + (data.reason || data.error));
        return;
    }

    const imgSrc = "data:image/png;base64," + data.file;
    document.getElementById("resultImg").src = imgSrc;
    document.getElementById("resultBox").style.display = "block";

    const dl = document.getElementById("downloadBtn");
    dl.href = imgSrc;
}
</script>

</body>
</html>
